"use strict";!function(){function e(e){try{var o='.personalization [persona-color-radio][persona-sku="'+e+'"]:checked',n=document.querySelector(o),r={};return n?(r.code=n.getAttribute("persona-color-code"),r.hexa=n.getAttribute("persona-color-hexa"),r.name=n.getAttribute("persona-color-name"),r):null}catch(t){return console.error("personalization.form.getPersonaObject",t),null}}function o(o){var n={sku:null,value:null};try{if(!o)return n;n.sku=o.getAttribute("persona-sku")||null,n.value="string"==typeof o.value?o.value:null;var r=e(n.sku);return r&&(n.color=r),n}catch(t){return console.error("personalization.form.getPersonaObject",t),n}}function n(){try{for(var e=document.querySelectorAll(".personalization [persona-input]"),n=e.length,r=[];n--;)c(e[n])&&r.push(o(e[n]));return r}catch(t){return console.error("personalization.form.getPersonaList",t),[]}}function r(e){var o=[];try{y&&(o=n())}catch(r){console.error("personalization.form.getPersonaValues",r)}finally{e(o,!0)}}function t(){try{var e={},o=document.forms[h];return o&&(e.name=o.querySelector("[data-personalization-name]")||null,e.number=o.querySelector("[data-personalization-number]")||null,e.color=o.querySelector("[radio-input]:checked")||null,e.text=o.querySelector("[data-personalization-text]")||null),e}catch(n){return console.error("personalization.form.getInputs",n),{}}}function a(){try{var e=t(),o=e.name,n=e.number,r=e.color,a=e.text;S.name=o&&o.value?o.value:S.name,S.number=n&&n.value?n.value:S.number,S.text=a&&a.value?a.value:S.text,S.color=r||S.color,S.status=y}catch(u){console.error("personalization.form.savePersonaState",u)}}function u(){try{var e=t(),o=e.name,n=e.number,r=e.text;r&&S.text&&(r.value=S.text),o&&S.name&&(o.value=S.name),n&&S.number&&(n.value=S.number),window.freedom.nsPubSub.pub("personalization.form.set.inputs",S),window.freedom.nsPubSub.pub("personalization.form.set.status",S.status)}catch(a){console.error("personalization.form.setPersonaState",a)}}function i(){try{var e=document.querySelector('#customization-name[name="cname"]'),o=document.querySelector('#customization-number[name="cnumber"]'),n=document.querySelector('#customization-text[name="ctext"]'),r=document.querySelector('[name="persona-color"]'),t=!!document.querySelector('[name="persona-color"]:checked');return{name:{name:"cname",status:c(e),active:e},number:{name:"cnumber",status:c(o),active:o},text:{name:"ctext",status:c(n),active:n},color:{name:"persona-color",status:t,active:r}}}catch(a){return console.error("personalization.getFormConfig"),{}}}function l(){try{window.freedom.nsPubSub.pub("personalization.form.toggleStatus",!1);var e=document.querySelectorAll('.personalization input[type="text"]'),o=document.querySelectorAll('.personalization input[type="radio"]');if(e)for(var n=e.length;n--;)e[n].addEventListener("input",function(){window.freedom.nsPubSub.pub("personalization.form.validate.changed",s())});if(o)for(var r=o.length;r--;)o[r].addEventListener("change",function(){window.freedom.nsPubSub.pub("personalization.form.validate.changed",s())})}catch(t){console.error("personalization.form.initObserveInputs",t)}}function s(){try{var e=i();return!(!(e.name.status||e.number.status||e.text.status)||e.color.active&&!e.color.status)}catch(o){return console.error("personalization.form.getFormValidate",o),!0}}function c(e){try{if(!e)return!1;var o=e.value.trim();return o.length>0}catch(n){return console.error("personalization.form.validateInput",n),!0}}function m(e){y=void 0===e?!y:e,window.freedom.nsPubSub.pub("personalization.form.toggle.status",y)}function f(e,o){try{return o.preventDefault(),!e.length||(z.showErrors(o.target,e),!1)}catch(n){return console.error("personalization.form.setPersonaState",n),!1}}function d(){try{window.freedom.nsPubSub.sub("formValidationCore.loaded",function(e){z=e,window.setTimeout(function(){window.freedom.nsPubSub.pub("formValidation.validateForm",{formName:h,validationCallback:f})},0)})}catch(e){console.error("personalization.form.initValidationForm",e)}}function b(e){try{e(w?s():!0)}catch(o){console.error("personalization.validatePersonaBuy",o),e(!0)}}function p(e){try{w=e}catch(o){console.error("personalization.changePersonaOpenStatus",o)}}function v(){try{window.freedom.nsPubSub.sub("personalization.get",r),window.freedom.nsPubSub.sub("color-flavor-size.changeHtml.before",a),window.freedom.nsPubSub.sub("color-flavor-size.changeHtml.after",u),window.freedom.nsPubSub.sub("personalization.restart",l),window.freedom.nsPubSub.sub("color-flavor-size.changeHtml.after",d),window.freedom.nsPubSub.sub("personalization.form.toggleStatus",m),window.freedom.nsPubSub.sub("personalization.form.changeOpenClosed",p),window.freedom.nsPubSub.sub("ColorFlavorSize.handleBuyEvent.checkPersona",b)}catch(e){console.error("personalization.form.initPubSub",e)}}var z,h="personalization-form",S={name:null,number:null,text:null,color:null,status:!1},w=!1,y=!1;l(),d(),v()}();